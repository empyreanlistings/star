<!DOCTYPE HTML>
<html lang="en">

<head>
    <title>Admin Dashboard - Kai & Isla</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css?v=2.41">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <style>
        /* Styles moved to assets/css/main.css?v=2.41
    </style>
    <!-- Apply saved theme early to prevent flash -->
    <script>
        (function () {
            const theme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            document.documentElement.style.backgroundColor = theme === 'dark' ? '#0f0f0f' : '#ffffff';
        })();
    </script>
</head>

<body class="is-preload dashboard-page">

    <!-- Protection & Auth Logic -->
    <style>
        body.dashboard-page {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        body.auth-verified {
            opacity: 1 !important;
        }
    </style>
    <script type="module" src="assets/js/auth.js"></script>

    <header class="dashboard-header">
        <div class="dashboard-logo">
            <a href="index.html">
                <img src="images/logo2-dark.png" alt="Kai & Isla" id="dashLogo">
            </a>
            <!-- Script to swap logo based on theme later if needed, but dark logo works on white header. 
                     In dark mode, header is dark, so dark logo might be lost. 
                     Let's handle logo swap in JS or Filter -->
        </div>
        <div class="user-info">
            <button id="themeToggleDash" class="theme-toggle" aria-label="Toggle Theme">
                <i class="theme-icon fas fa-moon"></i>
            </button>
            <a href="profile.html" id="navAvatarLink" class="nav-avatar" title="My Profile" style="display:none;">
                <img id="navAvatarImg" src="images/logo.png" alt="Profile" style="display:none;">
                <i id="navDashboardIcon" class="fas fa-user-circle" style="display:none;"></i>
            </a>
            <span id="userEmail" style="color:var(--dash-text);font-size:0.9rem;"></span>
            <button id="logoutBtn" class="btn-logout"><i class="fas fa-sign-out-alt"></i> <span
                    class="logout-text">Logout</span></button>
        </div>
    </header>

    <main class="dashboard-content">
        <div id="listingsSection" class="listings-table-container">
            <!-- Header with Add Button -->
            <div class="dashboard-section-header">
                <h1>Manage Listings</h1>
                <button id="addListingBtn" class="btn-add-icon" aria-label="Add New Listing">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <!-- Filters -->
            <div class="property-filters-container" style="margin-bottom: 2rem; position: relative;">
                <div class="property-gallery-filters" role="group" aria-label="Property type filters">
                    <button class="filter active" data-filter="all" type="button">ALL</button>
                    <button class="filter" data-filter="land" type="button">LAND</button>
                    <button class="filter" data-filter="residential" type="button">RESIDENTIAL</button>
                    <button class="filter" data-filter="commercial" type="button">COMMERCIAL</button>
                </div>

                <div class="price-filter-inline">
                    <div class="price-header-row">
                        <span class="price-label">Price:</span>
                        <span id="dashPriceRangeValue">Any Price</span>
                    </div>
                    <div class="slider-container-inline">
                        <input type="range" min="0" max="50000000" value="0" class="slider-inline" id="dashPriceMin">
                        <input type="range" min="0" max="50000000" value="50000000" class="slider-inline"
                            id="dashPriceMax">
                        <div class="slider-track-inline"></div>
                        <div class="slider-range-inline"></div>
                    </div>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <thead>
                            <tr>
                                <th style="width: 80px;">Image</th>
                                <th class="sortable" data-sort="title">Property <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="type">Type <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="price">Price <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="category">Category <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="featured">Featured <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="visits">Visits <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="likes">Likes <i class="fas fa-sort"></i></th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                <tbody id="listingsTableBody">
                    <tr>
                        <td colspan="7" style="text-align:center;padding:2rem;opacity:0.6;">Loading listings...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="gallerySection" class="listings-table-container">
            <!-- Header with Add Button -->
            <div class="dashboard-section-header">
                <h1>Manage Gallery</h1>
                <button id="addGalleryBtn" class="btn-add-icon" aria-label="Add New Gallery Item">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <!-- Filters -->
            <div class="property-filters-container" style="margin-bottom: 2rem; position: relative;">
                <div class="gallery-type-filters" role="group" aria-label="Gallery category filters">
                    <button class="filter active" data-filter="all" type="button">ALL</button>
                    <button class="filter" data-filter="structural" type="button">STRUCTURAL</button>
                    <button class="filter" data-filter="exterior" type="button">EXTERIOR</button>
                    <button class="filter" data-filter="interior" type="button">INTERIOR</button>
                    <button class="filter" data-filter="pool" type="button">SWIMMING POOLS</button>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Gallery Item</th>
                        <th>Category</th>
                        <th>Display</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="galleryTableBody">
                    <tr>
                        <td colspan="5" style="text-align:center;padding:2rem;opacity:0.6;">Loading gallery...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="palawanGallerySection" class="listings-table-container">
            <!-- Header with Add Button -->
            <div class="dashboard-section-header">
                <h1>Manage Palawan Gallery</h1>
                <button id="addPalawanGalleryBtn" class="btn-add-icon" aria-label="Add New Palawan Gallery Item">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Item Details</th>
                        <th>Display</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="palawanGalleryTableBody">
                    <tr>
                        <td colspan="5" style="text-align:center;padding:2rem;opacity:0.6;">Loading Palawan gallery...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <!-- Listing Modal -->
    <div id="listingModal" class="modal-overlay premium-modal">
        <div class="modal-content">
            <span id="closeModal" class="close-modal">&times;</span>
            <h3 id="modalTitle" class="modal-title">Add New Property</h3>
            <form id="listingForm">
                <input type="hidden" id="listingId">
                <div class="form-group">
                    <label>Property Title</label>
                    <input type="text" id="propTitle" class="form-control" required>
                </div>

                <div class="form-group" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
                    <div>
                        <label>Price (PHP)</label>
                        <input type="number" id="propPrice" class="form-control" required>
                    </div>
                    <div>
                        <label>Type (e.g. Villa, Land)</label>
                        <input type="text" id="propType" class="form-control">
                    </div>
                </div>

                <div class="form-group" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
                    <div>
                        <label>Category</label>
                        <select id="propCategory" class="form-control">
                            <option value="residential">Residential</option>
                            <option value="land">Land</option>
                            <option value="commercial">Commercial</option>
                        </select>
                    </div>
                    <div>
                        <label>Status</label>
                        <select id="propStatus" class="form-control">
                            <option value="for_sale">For Sale</option>
                            <option value="sold">Sold</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" style="display:flex;align-items:center;gap:0.5rem;margin-top:-0.5rem;">
                    <input type="checkbox" id="propFeatured" style="width:auto;margin:0;">
                    <label for="propFeatured" style="margin:0;cursor:pointer;font-size:0.9rem;">Featured Property (Logo
                        overlay & priority sorting)</label>
                </div>

                <div class="form-group">
                    <label>Thumbnail Image (Slide 1)</label>
                    <input type="file" id="propImage" class="form-control" accept="image/*">
                </div>

                <div class="form-group">
                    <label>Gallery Images (Slides 2+)</label>
                    <input type="file" id="propGallery" class="form-control" multiple accept="image/*">
                    <div id="galleryPreview" class="gallery-preview-grid"></div>
                </div>

                <div class="form-group">
                    <label>Short Description (Card)</label>
                    <input type="text" id="propShortDesc" class="form-control" required>
                </div>

                <div class="form-group">
                    <label>Full Description (Modal)</label>
                    <textarea id="propFullDesc" class="form-control" rows="4"></textarea>
                </div>

                <div class="form-group" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:0.5rem;">
                    <input type="number" id="propBeds" class="form-control" placeholder="Beds">
                    <input type="number" id="propBaths" class="form-control" placeholder="Baths">
                    <input type="number" id="propSize" class="form-control" placeholder="Size (sqm)">
                </div>

                <div class="form-group" style="display:grid;grid-template-columns:1fr 1fr;gap:0.5rem;">
                    <input type="number" id="propLotSize" class="form-control" placeholder="Lot Size (sqm)">
                    <input type="number" id="propFloorArea" class="form-control" placeholder="Floor Area (sqm)">
                </div>

                <div class="form-group">
                    <label>Features (comma separated)</label>
                    <input type="text" id="propFeatures" class="form-control" placeholder="Pool, Solar, View...">
                </div>

                <button type="submit" id="submitBtn" class="btn-add" style="width:100%;margin-top:1rem;">Create
                    Listing</button>
                <div id="uploadStatus" style="margin-top:0.5rem;text-align:center;font-size:0.9rem;opacity:0.8;"></div>
            </form>
        </div>
    </div>

    <!-- Gallery Modal -->
    <div id="galleryModal" class="modal-overlay premium-modal">
        <div class="modal-content">
            <span id="closeGalleryModal" class="close-modal">&times;</span>
            <h3 id="galleryModalTitle" class="modal-title">Add New Gallery Item</h3>
            <form id="galleryForm">
                <input type="hidden" id="galleryItemId">
                <div class="form-group">
                    <label>Headline (Title)</label>
                    <input type="text" id="galleryHeadline" class="form-control" required
                        placeholder="e.g. Spacious Pool House">
                </div>

                <div class="form-group">
                    <label>Sub-header (Description)</label>
                    <input type="text" id="gallerySubHeader" class="form-control"
                        placeholder="e.g. AAC Blockwork • Pool">
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <div id="galleryCategoryChips" class="category-chips">
                        <div class="chip active" data-value="structural">Structural</div>
                        <div class="chip" data-value="exterior">Exterior</div>
                        <div class="chip" data-value="interior">Interior</div>
                        <div class="chip" data-value="pool">Swimming Pools</div>
                    </div>
                </div>

                <div class="form-group" style="display:flex;align-items:center;gap:0.5rem;margin-bottom:1rem;">
                    <input type="checkbox" id="galleryDisplay" style="width:auto;margin:0;" checked>
                    <label for="galleryDisplay" style="margin:0;cursor:pointer;font-size:0.9rem;">Display in
                        Portfolio</label>
                </div>

                <div class="form-group">
                    <label>Image (Max width 1000px on upload)</label>
                    <input type="file" id="galleryImage" class="form-control" accept="image/*" required>
                </div>

                <button type="submit" id="gallerySubmitBtn" class="btn-add" style="width:100%;margin-top:1rem;">Upload
                    Gallery Item</button>
                <div id="galleryUploadStatus" style="margin-top:0.5rem;text-align:center;font-size:0.9rem;opacity:0.8;">
                </div>
            </form>
        </div>
    </div>

    <!-- Palawan Gallery Modal -->
    <div id="palawanGalleryModal" class="modal-overlay premium-modal">
        <div class="modal-content">
            <span id="closePalawanGalleryModal" class="close-modal">&times;</span>
            <h3 id="palawanGalleryModalTitle" class="modal-title">Add New Palawan Gallery Item</h3>
            <form id="palawanGalleryForm">
                <input type="hidden" id="palawanGalleryItemId">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="palawanGalleryTitle" class="form-control" required
                        placeholder="e.g. El Nido Bay">
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="palawanGalleryDescription" class="form-control"
                        placeholder="e.g. El Nido, Palawan">
                </div>

                <div class="form-group" style="display:flex;align-items:center;gap:0.5rem;margin-bottom:1rem;">
                    <input type="checkbox" id="palawanGalleryDisplay" style="width:auto;margin:0;" checked>
                    <label for="palawanGalleryDisplay" style="margin:0;cursor:pointer;font-size:0.9rem;">Display in
                        Palawan Gallery</label>
                </div>

                <div class="form-group">
                    <label>Image (Max width 1000px on upload)</label>
                    <input type="file" id="palawanGalleryImage" class="form-control" accept="image/*" required>
                </div>

                <button type="submit" id="palawanGallerySubmitBtn" class="btn-add"
                    style="width:100%;margin-top:1rem;">Upload
                    Palawan Gallery Item</button>
                <div id="palawanGalleryUploadStatus"
                    style="margin-top:0.5rem;text-align:center;font-size:0.9rem;opacity:0.8;">
                </div>
            </form>
        </div>
    </div>

    <!-- Property Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <button id="modalClose" class="modal-close" aria-label="Close modal">×</button>
        <div class="property-modal" id="propertyModal">
            <div class="modal-content">
                <img id="modalImage" class="modal-image" src="" alt="">
                <div class="modal-glass">
                    <div class="modal-header">
                        <div>
                            <h2 id="modalLocation"></h2><span id="modalType" class="modal-subtext"></span>
                        </div>
                        <h2 id="modalPrice" class="modal-price"></h2>
                    </div>
                    <div class="modal-stats">
                        <div><strong id="modalBeds"></strong><span>Beds</span></div>
                        <div><strong id="modalBaths"></strong><span>Baths</span></div>
                        <div><strong id="modalSize"></strong><span>sqm</span></div>
                    </div>
                    <div>
                        <h3>OVERVIEW</h3>
                        <p id="modalDescription"></p>
                    </div>
                    <div class="modal-section">
                        <h3>KEY FEATURES</h3>
                        <ul class="modal-features" id="modalFeatures"></ul>
                    </div>
                    <div class="modal-engagement">
                        <div class="engagement-stats">
                            <span><i class="far fa-eye"></i> <span id="modalVisits">0</span> <span
                                    id="modalVisitsLabel">visits</span></span>
                            <span><i class="far fa-heart"></i> <span id="modalLikes">0</span> <span
                                    id="modalLikesLabel">likes</span></span>
                        </div>
                        <button id="modalLikeBtn" class="btn-like" aria-label="Like Property"><i
                                class="far fa-heart"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/snackbar.js?v=2.41"></script>
    <script src="assets/js/main.js?v=2.41" defer></script>
    <script type="module" src="assets/js/admin-dashboard.js?v=2.41"></script>

</body>

</html>