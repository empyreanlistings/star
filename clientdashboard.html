<!DOCTYPE HTML>
<html lang="en">

<head>
    <title>Client Dashboard - Kai & Isla</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css?v=3.107">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <!-- Apply saved theme early to prevent flash -->
    <script>
        (function () {
            const theme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            document.documentElement.style.backgroundColor = theme === 'dark' ? '#0f0f0f' : '#ffffff';
        })();
    </script>
</head>

<body class="is-preload client-dashboard-page">

    <!-- Protection & Auth Logic -->
    <script type="module" src="assets/js/auth.js"></script>

    <header class="dashboard-header">
        <div class="dashboard-logo">
            <a href="index.html">
                <img src="images/logo_dark.png" alt="Kai & Isla" id="dashLogo">
            </a>
        </div>
        <div class="user-info">
            <button id="themeToggleDash" class="theme-toggle" aria-label="Toggle Theme">
                <i class="theme-icon fas fa-moon"></i>
            </button>
            <a href="profile.html" id="navAvatarLink" class="icon-button-default" title="My Profile"
                style="display:none;">
                <img id="navAvatarImg" src="images/logo_dark.png" alt="Profile" style="display:none;">
                <i id="navDashboardIcon" class="fas fa-user-circle" style="display:none;"></i>
            </a>
            <span id="userEmail" style="color:var(--dash-text);font-size:0.9rem;"></span>
            <button id="logoutBtn" class="icon-button-default" title="Logout">
                <i class="fas fa-sign-out-alt"></i>
            </button>
            <!-- Apps Button -->
            <button id="navAppsBtn" class="icon-button-default" aria-label="Apps" aria-expanded="false">
                <i class="fas fa-grip"></i>
            </button>
        </div>
    </header>

    <div id="apps-menu-placeholder"></div>

    <main class="dashboard-content">
        <div class="dashboard-section-header">
            <h1>CLIENT DASHBOARD</h1>
        </div>

        <div class="client-dash-grid">
            <!-- Project Overview -->
            <div class="client-card container-glass">
                <h2><i class="fas fa-project-diagram"></i> ACTIVE PROJECTS</h2>
                <div class="project-item" style="display:flex; gap:15px; align-items:center;">
                    <div
                        style="width:80px; height:80px; border-radius:8px; background:rgba(255,255,255,0.05); display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-home" style="font-size:2rem; opacity:0.3;"></i>
                    </div>
                    <div>
                        <h4 style="margin:0;">Tropical Modern Villa - Phase 1</h4>
                        <p style="margin:5px 0 0 0; font-size:0.85rem; opacity:0.6;">Bacungan, Puerto Princesa</p>
                        <div
                            style="margin-top:10px; height:6px; width:150px; background:rgba(255,255,255,0.1); border-radius:3px;">
                            <div style="height:100%; width:65%; background:var(--accent); border-radius:3px;"></div>
                        </div>
                        <p style="margin:5px 0 0 0; font-size:0.75rem; color:var(--accent);">65% Complete</p>
                    </div>
                </div>
            </div>

            <!-- Milestones -->
            <div class="client-card container-glass">
                <h2><i class="fas fa-tasks"></i> MILESTONES</h2>
                <div class="timeline">
                    <div class="timeline-item completed">
                        <h4>Land Preparation</h4>
                        <p>Completed Oct 15, 2025</p>
                    </div>
                    <div class="timeline-item completed">
                        <h4>Foundation & Footing</h4>
                        <p>Completed Dec 02, 2025</p>
                    </div>
                    <div class="timeline-item">
                        <h4>Structural Blockwork</h4>
                        <p>In Progress - Expected Feb 2026</p>
                    </div>
                    <div class="timeline-item">
                        <h4>Roofing & Sealing</h4>
                        <p>Scheduled for March 2026</p>
                    </div>
                </div>
            </div>

            <!-- Financials -->
            <div class="client-card container-glass">
                <h2><i class="fas fa-wallet"></i> PAYMENT SCHEDULE</h2>
                <table class="payment-table">
                    <thead>
                        <tr>
                            <th>Phase</th>
                            <th>Amount</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Downpayment</td>
                            <td>PHP 2.5M</td>
                            <td><span class="status-badge status-paid">PAID</span></td>
                        </tr>
                        <tr>
                            <td>Foundation</td>
                            <td>PHP 1.2M</td>
                            <td><span class="status-badge status-paid">PAID</span></td>
                        </tr>
                        <tr>
                            <td>Structure</td>
                            <td>PHP 1.8M</td>
                            <td><span class="status-badge status-pending">DUE</span></td>
                        </tr>
                        <tr>
                            <td>Finishing</td>
                            <td>PHP 2.0M</td>
                            <td><span class="status-badge status-pending">LATER</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Gallery Section -->
            <div class="client-card container-glass"
                style="grid-column: 1 / -1; width: 100%; margin: 0; max-width: none;">
                <h2><i class="fas fa-images"></i> CONSTRUCTION PROGRESS</h2>
                <div id="inspectionsGallery" class="mixed-gallery">
                    <!-- Dynamically populated from Inspections collection -->
                    <div class="gallery-loader"
                        style="grid-column: 1 / -1; text-align: center; padding: 3rem; opacity: 0.5;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Syncing latest inspections...</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Lightbox for Inspections -->
    <div id="inspections-lightbox" class="lightbox" role="dialog" aria-hidden="true" tabindex="-1">
        <div class="lightbox-arrow lightbox-prev">&#10094;</div>
        <img id="inspections-lightbox-img" src="" alt="">
        <div class="lightbox-arrow lightbox-next">&#10095;</div>
        <div class="lightbox-caption"></div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/snackbar.js?v=3.107"></script>
    <script src="assets/js/client-dashboard.js?v=3.107" type="module"></script>
    <script src="assets/js/main.js?v=3.107" defer></script>

</body>

</html>